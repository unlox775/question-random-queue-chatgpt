<!DOCTYPE html>
<html>
  <? var isAuthorized = checkUserAuthorization(); ?>
  <head>
    <title>Random Question Selector</title>
    <script src="https://apis.google.com/js/api.js?client_id=320617639949-sodt7i4u1tfgmn5cp5pjj2g5sd6tulak.apps.googleusercontent.com&amp;onload=init"></script>
  </head>
  <body>
    <? if (isAuthorized) { ?>
      <h1>Random Question Selector</h1>
      <p id="question">Click 'Find random question' to display a question</p>
      <button id="findRandom">Find random question</button><br/>
      <button id="copyQuestion">Copy question to clipboard</button><br/>
      <button id="openChatGPT">Open ChatGPT and mark as resolved</button><br/>
      <button id="neverMind">Never mind (unmark as resolved)</button>
    <? } else { ?>
      <h1>Unauthorized Access</h1>
      <p>You do not have access to this app.</p>
    <? } ?>

    <script src="https://apis.google.com/js/api.js"></script>
    <script>
document.getElementById('findRandom').addEventListener('click', () => {
  google.script.run.withSuccessHandler(displayQuestion).getSheetData();
});

function displayQuestion(question) {
  document.getElementById('question').textContent = question;
}

    </script>
  </body>
</html>

