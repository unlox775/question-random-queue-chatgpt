<!DOCTYPE html>
<html>
  <head>
    <title>Random Question Selector</title>
  </head>
  <body>
    <h1>Random Question Selector</h1>
    <p id="question">Click 'Find random question' to display a question</p>
    <button id="findRandom">Find random question</button><br/>
    <button id="copyQuestion">Copy question to clipboard</button><br/>
    <button id="openChatGPT">Open ChatGPT and mark as resolved</button><br/>
    <button id="neverMind">Never mind (unmark as resolved)</button>

    <script src="https://apis.google.com/js/api.js"></script>
    <script>
      // Client ID and API key from the Developer Console
const CLIENT_ID = '320617639949-sodt7i4u1tfgmn5cp5pjj2g5sd6tulak.apps.googleusercontent.com';
const API_KEY = 'AIzaSyDhhL_4VLxEAWk4v-wBGuQlNCNMRiIaOxI';

// Array of API discovery document URLs
const DISCOVERY_DOCS = ["https://sheets.googleapis.com/$discovery/rest?version=v4"];

// Authorization scopes required by the API
const SCOPES = "https://www.googleapis.com/auth/spreadsheets";

// Initialize the Google API client
function initClient() {
  gapi.client.init({
    apiKey: API_KEY,
    clientId: CLIENT_ID,
    discoveryDocs: DISCOVERY_DOCS,
    scope: SCOPES
  }).then(() => {
    // Listen for sign-in state changes.
    gapi.auth2.getAuthInstance().isSignedIn.listen(updateSigninStatus);

    // Handle the initial sign-in state.
    console.log('About to call updateSigninStatus()')
    updateSigninStatus(gapi.auth2.getAuthInstance().isSignedIn.get());
  }, error => {
    console.error(JSON.stringify(error, null, 2));
  });
}

// Load the Google API client and sign-in library
function handleClientLoad() {
  gapi.load('client:auth2', initClient);
}

// Update the UI based on the user's sign-in status
function updateSigninStatus(isSignedIn) {
    console.log(`isSignedIn: ${isSignedIn}`)

    if (isSignedIn) {
      const userEmail = gapi.auth2.getAuthInstance().currentUser.get().getBasicProfile().getEmail();
      console.log(`userEmail: ${userEmail}`)
      const myEmail = 'unlox775@gmail.com';
      
      if (userEmail === myEmail) {
        // User is signed in and has the appropriate access, you can now interact with the Google Sheets API
      } else {
        // User is signed in but does not have the appropriate access
        alert('You do not have access to this app.');
      }
    } else {
      // Prompt the user to sign in
      gapi.auth2.getAuthInstance().signIn();
    }
  }
  

// Add a script tag to the HTML that loads the Google API client
document.head.appendChild(Object.assign(document.createElement('script'), {
  src: 'https://apis.google.com/js/api.js',
  onload: handleClientLoad,
  async: true,
  defer: true
}));

    </script>
  </body>
</html>

